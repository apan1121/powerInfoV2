(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{104:function(t,e,a){"use strict";a.d(e,"a",(function(){return o})),a.d(e,"b",(function(){return l}));a(34).a;const o="Power/Chart",l={state:()=>({ChartColor:["#0099e5","#ff4c4c","#fbb034","#c1d82f","#8a7967","#6a737b","#d20962","#7d3f98","#537b35","#c4dff6","#003366","#a25016","#566127","#909090","#ecf0f1","#95a5a6","#ecf0f1","#95a5a6","#d35400","#c0392b","#bdc3c7","#7f8c8d"]}),mutations:{},actions:{},getters:{ChartColor:t=>t.ChartColor},namespaced:!0}},115:function(t,e,a){"use strict";(function(t){var o=a(3),l=a(15);e.a={components:{CardBox:()=>a.e(2).then(a.bind(null,173)),ChartTrend:()=>Promise.all([a.e(4),a.e(0),a.e(9)]).then(a.bind(null,538))},filters:{},mixins:[l.a],props:{title:{type:String,default:""},records:{type:Object,default:()=>{}},tooltipTotal:{type:Boolean,default:!0},tooltipUsedPercent:{type:Boolean,default:!0},icon:{type:[Boolean,String],default:!1},chartType:{type:String,default:"line"},stacked:{type:Boolean,default:!1}},data:()=>({fullscreenToggle:!1}),computed:{...Object(o.c)(["adBlocked"]),hasFooter(){return Object.keys(this.$slots).includes("footer")}},watch:{fullscreenToggle(e){e?(setTimeout(()=>{(window.adsbygoogle=window.adsbygoogle||[]).push({})},500),t("body").addClass("lock-scroll")):t("body").removeClass("lock-scroll")}},created(){},mounted(){},updated(){},destroyed(){},methods:{...Object(o.b)({}),...Object(o.d)({}),init(){},fullscreen(t){this.fullscreenToggle=t},downloadFile(){this.$refs.chartTrend.downloadFile()}}}}).call(this,a(16))},117:function(t,e,a){"use strict";(function(t){var o=a(3),l=a(2),s=a(102),r=a.n(s),n=a(171),d=a.n(n),i=a(71),c=a(104);e.a={components:{},filters:{},mixins:[i.a],props:{title:{type:String,default:""},records:{type:[Object,Boolean],default:!1},height:{type:[Boolean,Number],default:!1},tooltipTotal:{type:Boolean,default:!0},icon:{type:[Boolean,String],default:!1},newsTicker:{type:Array,default:()=>[]},fullscreenToggle:{type:Boolean,default:!1},tooltipUsedPercent:{type:Boolean,default:!1},chartType:{type:String,default:"line"},stacked:{type:Boolean,default:!1},download:{type:Boolean,default:!1}},data:()=>({ChartJS:null,exposured:!1,drawFlag:!1}),computed:{...Object(o.c)({ChartColor:c.a+"/ChartColor",PageSetting_width:"PageSetting_width",lang:"lang"})},watch:{PageSetting_width:{immediate:!0,handler(){this.draw()}},records:{immediate:!0,handler(){this.draw()}},height:{immediate:!0,handler(){this.draw()}},exposured:{handler(){this.draw()}},fullscreenToggle:{handler(){this.draw()}}},beforeCreate(){const t=this;t.$store.state[c.a]||t.$store.registerModule([c.a],c.b)},created(){},mounted(){this.ChartTarget=this.$refs.canvas},updated(){},destroyed(){},methods:{...Object(o.b)({}),...Object(o.d)({}),exposureAct(){this.exposured=!0},formatMoney:t=>t.toLocaleString(),draw(){const e=this;clearTimeout(e.drawTimer),e.exposured&&(e.drawFlag=!0,e.drawTimer=setTimeout(()=>{const{records:a}=e,{color:o}=r.a.helpers;null!==e.ChartJS&&e.ChartJS.destroy(),this.ChartTarget.height=this.calHeight();const s=[];let n={};for(const t in a){s.push(t);const l=a[t];Object.keys(l).forEach((t,a)=>{n[t]||(n[t]={type:e.chartType,label:t,backgroundColor:o(e.ChartColor[a]).alpha(.5).rgbString(),borderColor:e.ChartColor[a],borderWidth:1,fill:!1,data:[],pointRadius:1}),n[t].data.push(l[t]||0)})}n=Object.values(n);const i=[];if(e.newsTicker.length>0){const t="#f03434";e.newsTicker.forEach((e,a)=>{i.push({type:"line",id:"vline_"+a,mode:"vertical",scaleID:"x-axis-0",value:s.indexOf(e.date),borderColor:o(t).alpha(.8).rgbString(),borderWidth:1,label:{enabled:!0,position:"top",content:"ⓘ",backgroundColor:o(t).alpha(.8).rgbString(),rotation:90,fontSize:8,cornerRadius:3,xPadding:3,yPadding:3},onClick(){l.d.info({html:e.data.join("<br>"),showConfirmButton:!1}),console.log(e.data)}})})}const c={type:"bar",plugins:[d.a],data:{labels:s,datasets:n},options:{responsive:!0,title:{display:!1},tooltips:{enabled:!1,intersect:!1,mode:"index",custom:function(a){let o=e.$el.querySelector("#chartjs-tooltip");if(o||(o=document.createElement("div"),o.id="chartjs-tooltip",o.innerHTML="<table></table>",this._chart.canvas.parentNode.appendChild(o)),0===a.opacity)return void(o.style.opacity=0);o.classList.remove("above","below","no-transform"),a.yAlign?o.classList.add(a.yAlign):o.classList.add("no-transform");let l=0,s=0;if(a.body){const t=a.title||[],r=a.body.map((function(t){return t.lines}));let n="<thead>";t.forEach(t=>{n+=`<tr><th colspan="3">${t}</th></tr>`}),n+="</thead><tbody>";let d=0;if(r.forEach((t,o)=>{const r=a.labelColors[o];let i=[];i.push("background:"+r.backgroundColor),i.push("border-color:"+r.borderColor),i.push("border-width: 2px"),i.push("width: 16px;"),i.push("height: 16px"),i.push("display: inline-block"),i=i.join(";");const c=`<span class="chartjs-tooltip-key" style="${i}"></span>`;let[p,h]=t[0].split(": ");if(e.tooltipUsedPercent)switch(p){case"裝置容量":l+=parseFloat(h);break;case"已發電量":s+=parseFloat(h)}d+=parseInt(h),h=e.formatMoney(h),n+=`  <tr>\n                                                <td>${c}</td><td style="white-space:nowrap;">${p}</td><td style='text-align: right; white-space:nowrap;'>${h} <small>MW</small></td>\n                                            </tr>`}),e.tooltipTotal){d=e.formatMoney(d);let t=[];t.push("background: #EEE"),t.push("border-color: #EEE"),t.push("border-width: 2px"),t.push("width: 16px;"),t.push("height: 16px"),t.push("display: inline-block"),t=t.join(";");n+=`\n                                <tr>\n                                    <td>${`<span class="chartjs-tooltip-key" style="${t}"></span>`}</td><td>總額</td><td style='text-align: right;white-space:nowrap;'>${d} <small>MW</small></td>\n                                </tr>\n                            `}if(e.tooltipUsedPercent){const{CapacityFactor:t}=e.lang.summaryBox;d=0,l>0&&(d=s/l*100,d=d.toFixed(2));let a=[];a.push("background: #EEE"),a.push("border-color: #EEE"),a.push("border-width: 2px"),a.push("width: 16px;"),a.push("height: 16px"),a.push("display: inline-block"),a=a.join(";");n+=`\n                                    <tr>\n                                        <td>${`<span class="chartjs-tooltip-key" style="${a}"></span>`}</td><td style="white-space:nowrap;">${t}</td><td style='text-align: right;white-space:nowrap;'>${d} <small>%</small></td>\n                                    </tr>\n                                `}n+="</tbody>";o.querySelector("table").innerHTML=n}this._chart.canvas.offsetTop,this._chart.canvas.offsetLeft;const r=o.clientWidth+20,n=document.querySelector("body").clientWidth-20;o.style.position="absolute",o.style.opacity=1,o.style.left=a.caretX+r/3+"px",o.style.top="50%",o.style.fontFamily=a._bodyFontFamily,o.style.fontSize=a.bodyFontSize+"px",o.style.fontStyle=a._bodyFontStyle,o.style.background="#fafafa",o.style.border="1px solid #999",o.style.borderRadius="4px",o.style.padding=`${a.yPadding}px ${a.xPadding}px`,o.style.transform="translateY(-50%)",o.style.pointerEvents="none",t(o).offset().left<0&&(o.style.left=a.caretX+r/3+"px"),t(o).offset().left+t(o).width()>n&&(o.style.left=a.caretX-r+"px")}},hover:{mode:"nearest",intersect:!0},scales:{xAxes:[{display:!0,stacked:!!e.stacked,scaleLabel:{display:!0,labelString:"時間"},barPercentage:.5}],yAxes:[{display:!0,stacked:!!e.stacked,scaleLabel:{display:!0,labelString:"MW"},ticks:{callback:(t,e,a)=>l.e.carryFormatter(t)}}]},annotation:{events:["click"],drawTime:"afterDatasetsDraw",annotations:i}}},p=e.ChartTarget.getContext("2d");e.ChartJS=new r.a(p,c),e.drawFlag=!1},500))},calHeight(){const t=this;clearTimeout(t.initTimer);const{PageSetting_mode_type:e,records:a}=t;let o=100;if(this.$el&&this.$el.offsetWidth&&a){const{offsetWidth:l}=this.$el;if(o=l>1100?70:l>1e3?80:l>700?100:l>600?150:l>500?170:l>400?200:l>300?400:500,"mobile"===e){const t=Object.keys(Object.values(a)[0]).length;o+=15*parseInt(t/4)}t.fullscreenToggle&&(o+=40),o>=.5*window.innerHeight&&(o=.5*window.innerHeight)}return o},downloadFile(){const t=this,e=`台灣電廠即時資訊_${t.title}_${(new Date).getTime()}.csv`,a=[],o=Object.keys(t.records);if(o.length>0){const e=["日期"],l=[];Object.keys(t.records[o[0]]).forEach(t=>{e.push(t.replace(/\#/gi,"＃")),l.push(t)}),a.push(e),o.forEach(e=>{const o=[e];l.forEach(a=>{o.push(t.records[e][a])}),a.push(o)})}const s="data:text/csv;charset=utf-8,"+a.map(t=>t.join(",")).join("\n"),r=encodeURI(s),n=document.createElement("a");n.setAttribute("href",r),n.setAttribute("download",e),document.body.appendChild(n),n.click(),l.f.gtag("event","chart_trend_download",{title:t.title,type:"csv"}),l.f.mixpanel("chart_trend_download",{title:t.title,type:"csv"}),setTimeout(()=>{document.body.removeChild(n)},6e4)}}}}).call(this,a(16))},538:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t._self._c;return t.records?e("div",{staticClass:"chart-trend",class:{wait:!t.exposured||t.drawFlag}},[t.download&&Object.keys(t.records).length>0?e("div",{staticClass:"trend-download-btn",on:{click:t.downloadFile}},[e("i",{staticClass:"icon-download"})]):t._e(),t._v(" "),e("canvas",{ref:"canvas"}),t._v(" "),t.icon?e("i",{staticClass:"icon",class:t.icon}):t._e()]):t._e()};o._withStripped=!0;var l=a(117).a,s=a(4),r=Object(s.a)(l,o,[],!1,null,"748a97f3",null);e.default=r.exports},551:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t._self._c;return e("card-box",{attrs:{title:t.title,download:Object.keys(t.records).length>0},on:{download:t.downloadFile,fullscreen:t.fullscreen},scopedSlots:t._u([t.hasFooter?{key:"footer",fn:function(){return[t._t("footer")]},proxy:!0}:null],null,!0)},[t.records?e("chart-trend",{ref:"chartTrend",attrs:{title:t.title,"tooltip-total":t.tooltipTotal,"tooltip-used-percent":t.tooltipUsedPercent,icon:t.icon,records:t.records,"fullscreen-toggle":t.fullscreenToggle,"chart-type":t.chartType,stacked:t.stacked}}):t._e(),t._v(" "),t.fullscreenToggle?[e("div",{ref:"ads",staticClass:"power-info-promote",class:{"ad-blocked":t.adBlocked}},[e("ins",{staticClass:"adsbygoogle",staticStyle:{display:"block"},attrs:{"data-ad-format":"fluid","data-ad-layout-key":"-fb+5w+4e-db+86","data-ad-client":"ca-pub-3068501078221920","data-ad-slot":"1897408904"}})])]:t._e()],2)};o._withStripped=!0;var l=a(115).a,s=a(4),r=Object(s.a)(l,o,[],!1,null,"50a2c16c",null);e.default=r.exports}}]);